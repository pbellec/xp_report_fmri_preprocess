<!DOCTYPE html>
<html>

<head>
  <title>Report on fMRI motion levels</title>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
  <link rel="stylesheet" type="text/css" href="motion.css" /> <!--from keen.io-->
  <link rel="stylesheet" type="text/css" href="assets/bootstrap/bootstrap.min.css" /> <!--from keen.io-->
  <link rel="stylesheet" type="text/css" href="assets/keen/keen-dashboards.css" />    <!--from keen.io-->
  <link href="assets/select2/select2.min.css" rel="stylesheet" /> <!--from select 2-->
  <link href="assets/c3js/c3.min.css" rel="stylesheet" type="text/css"> <!--from c3.js-->
</head>
<body class="application">

  <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://niak.simexp-lab.org/pipe_preprocessing.html">fMRI preprocessing pipeline</a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-left">
          <li><a href="summary.html">Summary</a></li>
          <li><a href="registration.html">Registration</a></li>
          <li><a href="motion.html">Motion</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="container-fluid">

<!-- Translation plots -->
    <div class="row">
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            Translation parameters
          </div>
          <div class="chart-stage">
            <div id="chartTsl" style="width:100%"></div>
          </div>
          <div class="chart-notes">
            Click to select a time point. Mouse scroll to zoom.
          </div>
        </div>
      </div>
      
<!-- Rotation plots -->
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            Rotation parameters
          </div>
          <div class="chart-stage">
            <div id="chartRot" style="width:100%"></div>
          </div>
          <div class="chart-notes">
            Click to select a time point. Mouse scroll to zoom.
          </div>
        </div>
      </div>
      
<!-- FD plots -->
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            Frame displacement
          </div>
          <div class="chart-stage">
            <div id="chartFd" style="width:100%"></div>
          </div>
          <div class="chart-notes">
            Click to select a time point. Mouse scroll to zoom.
          </div>
        </div>
      </div>
      
<!-- Motion visualizer in native space -->
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            fMRI time frames in native space
          </div>
          <div class="chart-stage">
            <img class="sliderNext" src="assets/jsImageSlider/navbuttons2.gif" >
            <img class="sliderPrev" src="assets/jsImageSlider/navbuttons2.gif" >
            <canvas id="sliderNative" width="582px" heigth="auto"> 
            <img id="spriteNative" src="motion_subject1_native.png">
          </div>
          <div class="chart-notes">
            Click the left/right arrows to go forward/backward in time.
          </div>
        </div>
      </div>
      
<!-- Motion visualizer in stereotaxic space -->
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            Cell Title
          </div>
          <div class="chart-stage">
            <img data-src="holder.js/100%x180/white">
          </div>
          <div class="chart-notes">
            Notes about this chart
          </div>
        </div>
      </div>
      
<!-- Registration with the session/run of reference -->      
      <div class="col-sm-6 col-md-4">
        <div class="chart-wrapper">
          <div class="chart-title">
            Cell Title
          </div>
          <div class="chart-stage">
            <img data-src="holder.js/100%x180/white">
          </div>
          <div class="chart-notes">
            Notes about this chart
          </div>
        </div>
      </div>
<!-- end of three -->
    </div>



    <hr>

    <p class="small text-muted">Built with &#9829; by <a href="http://niak.simexp-lab.org">NIAK</a> using dashboards from <a href="https://keen.io">Keen IO</a></p>

  </div>

  <!--Dependencies-->
  <script src="assets/d3js/d3.min.js" charset="utf-8"></script>
  <script src="assets/c3js/c3.min.js"></script></head>
  <script type="text/javascript" src="assets/jquery/jquery.min.js"></script>       <!--from keen.io-->
  <script type="text/javascript" src="assets/bootstrap/bootstrap.min.js"></script> <!--from keen.io-->
  <script type="text/javascript" src="assets/keen/keen.min.js"></script>           <!--from keen.io-->
  <script src="assets/select2/select2.min.js"></script> <!--from select 2-->
  
  <script> 
  $( window ).load(function() {
    var canvas = document.getElementById('sliderNative');
    var ctx = canvas.getContext('2d');
    ctx.drawImage(document.getElementById('spriteNative'),
                0, 0, 192, 64, 15, 0, 562, 64*562/192);
    $('#sliderNative').data("numFrame",0);
  });

  var tsl = {
  columns: [
    $TSL
    ],
    onclick: function (d) { selectTime("motionNative",-d.index*64);}
  };
  
  var rot = {
  columns: [
    $ROT
    ]
  };

  var fd = {
  columns: [
    $FD
    ]
  };
    
  function nextTime(type) {
    numFrame = $('#sliderNative').data("numFrame");
    var canvas = document.getElementById('sliderNative');
    var ctx = canvas.getContext('2d');
    nextFrame = Math.min(numFrame+1,50);
    ctx.drawImage(document.getElementById('spriteNative'),
                nextFrame*192, 0, 192, 64, 15, 0, 562, 64*562/192);
    $('#sliderNative').data("numFrame",nextFrame);
    };

  function prevTime(type) {
    numFrame = $('#sliderNative').data("numFrame");
    var canvas = document.getElementById('sliderNative');
    var ctx = canvas.getContext('2d');
    prevFrame = Math.max(numFrame-1,0);
    ctx.drawImage(document.getElementById('spriteNative'),
                prevFrame*192, 0, 192, 64, 15, 0, 562, 64*562/192);
    $('#sliderNative').data("numFrame",prevFrame);
    };

  function reactKey(key){
    if (key=37) {
      nextTime("motionNative")
    } 
    else if (key=39) {
      prevTime("motionNative") 
    };
  };
  
  window.onload = function() {
    document.getElementsByClassName("sliderNext")[0].onclick = function fun() {
      nextTime("motionNative");
      }
    document.getElementsByClassName("sliderPrev")[0].onclick = function fun() {
      prevTime("motionNative");
      }
    };
    
  window.onkeydown = function(e) { reactKey(e.keyCode) 
      };

  var chartTsl = c3.generate({
    bindto: '#chartTsl',
    data: tsl,
    axis: {
        x: {
            label: 'Time (TRs)'
        },
        y: {
            label: 'Translation (mm)'
        }
    },
    zoom: {
      enabled: true
    },
  });
  
  var chartRot = c3.generate({
    bindto: '#chartRot',
    data: rot,
    axis: {
        x: {
            label: 'Time (TRs)'
        },
        y: {
            label: 'Rotation (degrees))'
        }
    },
    zoom: {
      enabled: true
    }
  });
  
  var chartRot = c3.generate({
    bindto: '#chartFd',
    data: fd,
    axis: {
        x: {
            label: 'Time (TRs)'
        },
        y: {
            label: 'Frame displacement (pseudo mm))'
        },
        y2: {
            show: true,
            label: 'Scrubbing (0: no / 1: yes))'
        }
    },
    zoom: {
      enabled: true
    }
  });

  </script>
 
</body>
</html>
